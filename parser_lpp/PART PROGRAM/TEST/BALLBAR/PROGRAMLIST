%
O0999;

(Programa interferómetro)
(Cargar renombrar y machacar PROGRAMLIST en la carpeta data del HMI)
(Hacerse una copia de PROGRAMLIST)

(EL PROGRAMA SE INICIARÁ EN LA POSICIÓN ACTUAL)

(DESACTIVAMOS EL RAYO)
M26

(DISTANCIA ENTRE PUNTOS)
(SUSTITUIR ASTERISCOS)
#1=50;

(LONGITUD APARATO DE MEDICION)
(SUSTITUIR ASTERISCOS)
#2=0;

(VELOCIDAD DE MEDICION)
(SUSTITUIR ASTERISCOS)
#7=2000;

(TIEMPO DE ESPERA ENTRE MEDICIONES)
(SUSTITUIR ASTERISCOS)
#8=4;


(CÁLCULO NUEVA LONGITUD DE MÁQUINA)
(SUPONEMOS EJE X: #5025)
(SI FUERA EJE Y: PRM[1320]/[2])
(SI FUERA EJE X2: PRM[1320]/[5])
#3=#5025-#2;

(CÁLCULO DE CÚANTO RESTA HASTA LA LONGITUD TOTAL)
(SUPONEMOS EJE X: #5021)
(SI FUERA EJE Y: #5022)
(SI FUERA EJE X2: #5025)
#4=#3-3100;

(CÁLCULO DEL NÚMERO DE PASOS)
#5=FIX[#4/#1]

(COMPENSAMOS BACKLASH)
(SUPONEMOS EJE X)
G55
G91G0X-1
G91G0X1

(PARO PARA MEDICIÓN)
M0;

#6=0;
(BUCLE 1 DE MEDICIÓN)
WHILE[#6LT#5]DO1
G91G1X#1F#7;
G04X#8;
#6=#6+1;
END1

(COMPENSAMOS BACKLASH)
(SUPONEMOS EJE X)
G55
G91G0X2
G91G0X-2
G04X#8;

#6=0;
(BUCLE 2 DE MEDICIÓN)
WHILE[#6LT#5]DO1
G91G1X[-[#1]]F#7;
G04X#8;
#6=#6+1;
END1

(HABILITACIÓN DE RAYO)
M27

M30
%